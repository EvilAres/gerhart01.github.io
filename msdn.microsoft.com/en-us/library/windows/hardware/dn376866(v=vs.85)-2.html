<!DOCTYPE html>

<html dir="ltr" xmlns="http://www.w3.org/1999/xhtml" lang="en">
    
<!-- Mirrored from msdn.microsoft.com/en-US/library/windows/hardware/dn376866(v=vs.85).aspx by HTTrack Website Copier/3.x [XR&CO'2013], Mon, 17 Mar 2014 16:57:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head><link rel="canonical" href="dn376866(v%3dvs.85).html" />
        <title>Send USB isochronous transfers from a WinUSB desktop app (Windows Drivers)</title>




<meta name="DCS.dcsuri" content="/en-us/library/windows/hardware/dn376866(d=default,l=en-us,v=vs.85).aspx" />

<meta name="NormalizedUrl" content="http://msdn.microsoft.com/en-us/library/windows/hardware/dn376866(d=default,l=en-us,v=vs.85).aspx" />

<meta name="ms.normalizedurl" content="http://msdn.microsoft.com/en-us/library/windows/hardware/dn376866(d=default,l=en-us,v=vs.85).aspx" />

<meta name="VotingContextUrl" content="http://msdn.microsoft.com/en-us/library/windows/hardware/dn376866(d=default,l=en-us,v=vs.85).aspx" />

<meta name="MN" content="61C41DD0-9:02:04 AM" />

<meta name="Search.ShortId" content="dn376866" />

<meta name="ms.shortidmsdn" content="dn376866" />

<meta name="Ms.Locale" content="en-us" />







        
    <link rel="shortcut icon" href="http://msdn.microsoft.com/Areas/Epx/Themes/Windows/Content/Winlogo_favicon.ico" />

    <link rel="stylesheet" type="text/css" href="../../../../../i3.msdn.microsoft.com/Combined4208.css?resources=0:Topic,0:CodeSnippet,0:ExpandableCollapsibleArea,1:CommunityContent,0:TopicNotInScope,0:FeedViewerBasic,0:ImageSprite,2:Header,2:sprite,1:Toc,0:NavSidebar,1:LibraryMemberFilter,2:Footer,3:DetailedLinkList,3:LinkList,4:Windows;/Areas/Epx/Content/Css:0,/Areas/Library/Content:1,/Areas/Epx/Themes/Windows/Content:2,/Areas/Epx/Themes/Base/Content:3,/Areas/Library/Themes/Windows/Content:4&amp;amp;hashKey=5D7E9AF826019A37D7275CF4C655CC6D" /></head>
    <body class="library ">
        <div id="page">
            
            
  
            
    
    

    <div id="ux-header" class=" ltr">
        <div id="headerContainer">
            <div id="logoAndSearchBox">
                <div id="logo">
                    <a href="http://msdn.microsoft.com/windows/" title="Windows"><img alt="Windows" src="../../../../../i.msdn.microsoft.com/Areas/Epx/Themes/Windows/Content/Windows_logo.png"></img></a>       
                </div>
              
        <div id="selectedTab">
            <a class="dropDownToggle" href="javascript:void(0);">Dev Center - Hardware</a>    
        </div>
    <div id="toclevel1_menu" style="display: none;">
        <ul>
                <li><a href="http://msdn.microsoft.com/windows/" title="Dev Center Home">Dev Center Home</a></li>
                <li><a href="http://msdn.microsoft.com/windows/apps/" title="Windows Store apps">Windows Store apps</a></li>
                <li><a href="http://msdn.microsoft.com/ie/" title="Internet Explorer">Internet Explorer</a></li>
                <li><a href="http://msdn.microsoft.com/windows/desktop/" title="Desktop">Desktop</a></li>
                <li><a href="http://msdn.microsoft.com/windows/hardware/" title="Hardware">Hardware</a></li>
        </ul>
        <div style="clear: both"></div>
    </div> 

                
                  

        <div class="SearchBox">   
            <form id="HeaderSearchForm" name="HeaderSearchForm" method="get" onsubmit="return Epx.Controls.SearchBox.searchBoxOnSubmit(this);">
            <input id="HeaderSearchTextBox" name="query" type="text" maxlength="200" onfocus="Epx.Controls.SearchBox.watermarkFocus(event, this.title)" onblur="Epx.Controls.SearchBox.watermarkBlur(event, this.title)" />            
            <button id="HeaderSearchButton" value="" type="submit" class="header-search-button"></button>
            </form>
         
                
                 
    
        </div>

                <div class="Clear"></div>
            </div>
            <div class="Clear"></div>
            <div class="ux-internav">
    <div class="toclevel2"> 
            <a class="normal" href="https://sysdev.microsoft.com/en-us/hardware/" title="Dashboard">Dashboard</a>
            <a class="normal" href="http://msdn.microsoft.com/windows/hardware/gg507680" title="Get Started ">Get Started </a>
            <a class="normal" href="http://msdn.microsoft.com/windows/hardware/gg462970" title="Design">Design</a>
            <a class="active" href="http://msdn.microsoft.com/windows/hardware/ff960953" title="Develop">Develop</a>
            <a class="normal" href="http://msdn.microsoft.com/windows/hardware/gg463010" title="Certify">Certify</a>
    </div>
    <div class="clear"></div>

            </div>
            <div id="signIn">

<a class="scarabLink" href="https://login.live.com/login.srf?wa=wsignin1.0&amp;rpsnv=12&amp;ct=1395072124&amp;rver=6.0.5276.0&amp;wp=MCLBI&amp;wlcxt=MSDN%24MSDN%24MSDN&amp;wreply=http%3a%2f%2fmsdn.microsoft.com%2fen-US%2flibrary%2fwindows%2fhardware%2fdn376866%2528v%3dvs.85%2529.aspx&amp;lc=1033&amp;id=254354&amp;mkt=en-US" title="Sign in">Sign in</a></div>

    

        </div>  
        <div id="blackBar">
    <div class="toclevel3"> 
            <a class="normal" href="http://msdn.microsoft.com/library/windows/hardware/gg454504" title="Systems">Systems</a>
            <a class="normal" href="http://msdn.microsoft.com/library/windows/hardware/gg454505" title="Devices">Devices</a>
            <a class="active" href="http://msdn.microsoft.com/library/windows/hardware/ff557573" title="Drivers">Drivers</a>
            <a class="normal" href="http://msdn.microsoft.com/library/windows/hardware/ff551063(v=vs.85).aspx" title="Debugging">Debugging</a>
            <a class="normal" href="http://msdn.microsoft.com/windows/hardware/gg454513" title="Downloads">Downloads</a>
            <a class="normal" href="http://msdn.microsoft.com/windows/hardware/dn433227.aspx" title="Samples">Samples</a>
            <a class="normal" href="http://msdn.microsoft.com/windows/hardware/gg454517" title="Community">Community</a>
            <a class="normal" href="http://msdn.microsoft.com/windows/hardware/dn550976" title="Archives">Archives</a>
    </div>
    <div class="clear"></div>

        </div>
    </div>


        
            <div id="body">
                







    <div id="leftNav">



<div id="tocnav">
            <div class="toclevel0" data-toclevel="0">
<a data-tochassubtree="true" href="ff557557(v%3dvs.85).html" id="ff576019_VS.85_en-us" mtpsaliasid="" mtpsassetid="1ef3e216-1322-42c3-b070-94cddfb2133c_VS.85_en-us" mtpsshortid="ff557557_VS.85_en-us" title="Device and Driver Technologies">Device and Driver Technologies</a>            </div>
            <div class="toclevel0" data-toclevel="0">
<a data-tochassubtree="true" href="ff557547(v%3dvs.85).html" id="hh440424_VS.85_en-us" mtpsaliasid="" mtpsassetid="5cefa114-cec1-4058-a7a9-08e0b13fe412_VS.85_en-us" mtpsshortid="ff557547_VS.85_en-us" title="Bus and Port Drivers">Bus and Port Drivers</a>            </div>
            <div class="toclevel0" data-toclevel="0">
<a data-tochassubtree="true" href="ff538930(v%3dvs.85).html" id="dn303474_VS.85_en-us" mtpsaliasid="" mtpsassetid="45ba2638-b1b9-409d-bd23-78e75a3515be_VS.85_en-us" mtpsshortid="ff538930_VS.85_en-us" title="Universal Serial Bus (USB)">Universal Serial Bus (USB)</a>            </div>
            <div class="toclevel0" data-toclevel="0">
<a data-tochassubtree="true" href="dn303342(v%3dvs.85).html" id="hh948125_VS.85_en-us" mtpsaliasid="" mtpsassetid="B3F1A1A6-0908-4144-8454-76A2FB70619B_VS.85_en-us" mtpsshortid="dn303342_VS.85_en-us" title="Developing Windows applications for USB devices">Developing Windows applications for USB devices</a>            </div>
            <div class="toclevel1" data-toclevel="1">
<a data-tochassubtree="true" href="dn376885(v%3dvs.85).html" id="dn376892_VS.85_en-us" mtpsaliasid="" mtpsassetid="CECFF842-73BD-4FB2-9FC5-E531D10E74EC_VS.85_en-us" mtpsshortid="dn376885_VS.85_en-us" title="Windows desktop app for a USB device">Windows desktop app for a USB device</a>            </div>
            <div class="toclevel2" data-toclevel="2">
<a href="dn376872(v%3dvs.85).html" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Write a Windows desktop app based on the WinUSB template">Write a Windows desktop app based on the WinUSB template</a>            </div>
            <div class="toclevel2" data-toclevel="2">
<a href="ff540174(v%3dvs.85).html" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="How to Access a USB Device by Using WinUSB Functions">How to Access a USB Device by Using WinUSB Functions</a>            </div>
            <div class="toclevel2 current" data-toclevel="2">
<a href="dn376866(v%3dvs.85).html" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="Send USB isochronous transfers from a WinUSB desktop app">Send USB isochronous transfers from a WinUSB desktop app</a>            </div>
            <div class="toclevel2" data-toclevel="2">
<a href="ff728833(v%3dvs.85).html" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="WinUSB Functions for Pipe Policy Modification">WinUSB Functions for Pipe Policy Modification</a>            </div>
            <div class="toclevel2" data-toclevel="2">
<a href="ff728834(v%3dvs.85).html" mtpsaliasid="" mtpsassetid="" mtpsshortid="" title="WinUSB Power Management">WinUSB Power Management</a>            </div>
</div>
        

        

        
        
        <div id="toc-resizable-ew" class="toc-resizable-ew"></div>
        
    </div>
<div id="content" class="content">







        

<div class="topic" xmlns="http://www.w3.org/1999/xhtml">
  <h1 class="title">Send USB isochronous transfers from a WinUSB desktop app</h1>
  
  <div id="mainSection">
<div class="clsServerSDKContent">

</div>
<div class="Nav_Sidebar" xmlns=""><span class="sidebar_heading" xmlns="http://www.w3.org/1999/xhtml">Summary</span>
<div class="sidebar_summary" xmlns="http://www.w3.org/1999/xhtml">
<p>
</p><ul>
<li>Brief overview of isochronous transfers.</li>
<li>Transfer buffer calculation based on endpoint interval values.</li>
<li>Sending transfers that read and write isochronous data by using <a href="ff540174(v%3dvs.85)-2.html">WinUSB Functions</a>.</li>
</ul>

</div>
<span class="sidebar_heading" xmlns="http://www.w3.org/1999/xhtml">In this article</span>
<div class="sidebar_toc" xmlns="http://www.w3.org/1999/xhtml">
<p>
</p><ul>
<li><a href="#before_you_start...">Before you start...</a></li>
<li><a href="#step_1__find_the_isochronous_pipe_in_the_active_setting">Step 1: Find the isochronous pipe in the active setting</a></li>
<li><a href="#step_2__get_interval_information_about_the_isochronous_pipe">Step 2: Get interval information about the isochronous pipe</a></li>
<li><a href="#step_3__send__a_write_transfer_to_send_data_to_an_isochronous_out_endpoint">Step 3: Send  a write transfer to send data to an isochronous OUT endpoint</a></li>
<li><a href="#step_4__send__a_read_transfer_to_receive_data_from_an_isochronous_in_endpoint">Step 4: Send  a read transfer to receive data from an isochronous IN endpoint</a></li>
</ul>

</div>
<span class="sidebar_heading" xmlns="http://www.w3.org/1999/xhtml">Important APIs</span>
<div class="sidebar_summary" xmlns="http://www.w3.org/1999/xhtml">
<p>
</p><ul>
<li>
<a href="dn265563(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_QueryPipeEx</strong></a>
</li>
<li>
<a href="dn265569(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_WriteIsochPipeAsap</strong></a>
</li>
<li>
<a href="dn265565(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_ReadIsochPipeAsap</strong></a>
</li>
</ul>

</div>
</div>
<p>Starting in  Windows 8.1, the set of <a href="ff540174(v%3dvs.85)-2.html">WinUSB Functions</a> have APIs that allow a desktop application to transfer data to and from isochronous endpoints of a USB device. For such an application, the Microsoft-provided Winusb.sys must be the device driver. </p>
<p>A USB device can support isochronous endpoints to transfer time-dependent data at a steady rate, such as with audio/video streaming. There is no guaranteed delivery. A good connection shouldn’t drop any packets, it is not normal or expected to lose packets, but the isochronous protocol is tolerant of such losses.</p>
<p>The host controller sends or receives data during reserved periods of time on the bus, are called <em>bus intervals</em>. The unit of bus interval depends on the bus speed. For full speed, it's 1-millisecond frames, for high speed and SuperSpeed, it's 250-microseconds microframes.</p>
<p>The host controller polls the device at regular intervals.   For read operations, when the endpoint is ready to send data, the device responds by sending data in the bus interval. To write to the device, the host controller sends data.</p>
<p><strong>How much data can the app send in one service interval</strong></p>
<p> The term <em>isochronous packet</em> in this topic refers to the amount of data that is transferred in one service interval. That value is calculated by the USB driver stack and the app can  get the value  while querying pipe attributes.</p>
<p>The size of an isochronous packet determines the size of the transfer buffer that the app allocates. The buffer must end at a frame boundary. The total size of the transfer depends on how much data the app wants to send or receive. After the transfer is initiated by the app, the host packetizes the transfer buffer so that in each interval, the host can send or receive the maximum bytes allowed per interval. </p>
<p>For a data transfer, not all bus intervals are used. In this topic, bus intervals that are used are called <em>service intervals</em>.</p>
<p><strong>How to calculate the frame in which data is transmitted</strong></p>
<p>The app can choose to specify the frame in one of two ways:</p>
<ul>
<li>Automatically. In this mode, the app instructs the USB driver stack to send the transfer in the next appropriate frame. The app must also specify whether the buffer is a continuous stream so that the driver stack can calculate the start frame.</li>
<li>Specifying the start frame that is later than the current frame. The app should take into consideration the latency between the time that the app starts the transfer and when the USB driver stack processes it. </li>
</ul>
<p><strong>Code example discussion</strong></p>
<p>The examples in this topic demonstrate the use of these <a href="ff540174(v%3dvs.85)-2.html">WinUSB Functions</a>:</p><ul>
<li>
<a href="dn265563(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_QueryPipeEx</strong></a>
</li>
<li>
<a href="dn265566(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_RegisterIsochBuffer</strong></a>
</li>
<li>
<a href="dn265567(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_UnregisterIsochBuffer</strong></a>
</li>
<li>
<a href="dn265569(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_WriteIsochPipeAsap</strong></a>
</li>
<li>
<a href="dn265565(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_ReadIsochPipeAsap</strong></a>
</li>
<li>
<a href="dn265568(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_WriteIsochPipe</strong></a>
</li>
<li>
<a href="dn265564(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_ReadIsochPipe</strong></a>
</li>
<li>
<a href="dn265549(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_GetCurrentFrameNumber</strong></a>
</li>
<li>
<a href="dn265548(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_GetAdjustedFrameNumber</strong></a>
</li>
</ul>

<p>In this topic, we'll read and write 30 milliseconds of  data in three transfers to a high speed device. The pipe is capable of transferring 1024 bytes in each service interval. Because the polling interval is 1, data is transferred in every microframe of a frame. Total of 30 frames will carry 30*8*1024 bytes. </p>
<p>The function calls for sending read and write transfers are similar. The app allocates a transfer buffer big enough to hold all three transfers. The app registers the buffer for a particular pipe by calling <a href="dn265566(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_RegisterIsochBuffer</strong></a>. The call returns a registration handle which is used to send the transfer. The buffer is reused for subsequent transfers and offset in the buffer is adjusted to send or receive the next set of data. </p>
<p>All transfers in the example are sent asynchronously. For this, the app allocates an array of <a href="bb773368(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">OVERLAPPED</strong></a> structure with three elements, one  for each transfer. The app provides events so that it can get notified when transfers complete and retrieve the results of the operation. For this, in each <strong>OVERLAPPED</strong> structure in the array,  the app allocates an event and sets the handle in the <strong>hEvent</strong> member.</p>
<p>This image shows three read transfers by using the <a href="dn265565(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_ReadIsochPipeAsap</strong></a> function. The call specifies offset and length of each transfer. The <em>ContinueStream</em> parameter value is FALSE to indicate a new stream. After that, the app requests that subsequent transfers are scheduled immediately following the last frame of the previous request to allow for continuous streaming of data. The number of isochronous packets are calculated as packets per frame * number of frames; 8*10. For this call, the app need not worry about calculating start frame number.  </p>
<p><img id="Isoch_app_read" alt="WinUSB function for isochronous read transfer" src="../../../../../i.msdn.microsoft.com/dynimg/IC674889.png" title="WinUSB function for isochronous read transfer" xmlns="" /></p>
<p>This image shows three write transfers by using the <a href="dn265568(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_WriteIsochPipe</strong></a> function. The call specifies offset and length of each transfer. In this case, the app must calculate the frame number in which the host controller can start sending data. On output, the function receives the frame number of the frame  that follows the last frame used in the previous transfer. To get the current frame, the app calls <a href="dn265549(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_GetCurrentFrameNumber</strong></a>.  At this point, the app must make sure that the start frame of the next transfer is later than the current frame, so that the USB driver stack does not drop late packets. To do so, the app calls <a href="dn265548(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_GetAdjustedFrameNumber</strong></a> to get a realistic current frame number (this is later than the received current frame number). To be on the safe side, the app adds five more frames, and then sends the transfer. </p>
<p><img id="Isoch_app_write" alt="WinUSB function for isochronous write transfer" src="../../../../../i.msdn.microsoft.com/dynimg/IC674890.png" title="WinUSB function for isochronous write transfer" xmlns="" /></p>
<p>After each transfer completes, the app gets the results of the transfer by calling <a href="ff540263(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_GetOverlappedResult</strong></a>. The <em>bWait</em> parameter is set to TRUE so that the call does not return until the operation has completed. For read and write transfers, the <em>lpNumberOfBytesTransferred</em> parameter is always 0. For a write transfer, the app assumes that if the operation completed successfully, all bytes were transferred. For a read transfer, the <strong>Length</strong> member of each isochronous packet (<a href="ff539084(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">USBD_ISO_PACKET_DESCRIPTOR</strong></a>), contains the number bytes transferred in that packet, per interval.  To get the total length, the app adds all <strong>Length</strong> values.</p>
<p>When finished, the app releases the isochronous buffer handles by calling <a href="dn265567(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_UnregisterIsochBuffer</strong></a>.</p>
<p></p>
<h2><a id="Before_you_start..."></a><a id="before_you_start..."></a><a id="BEFORE_YOU_START..."></a>Before you start...</h2>
<p>Make sure that, </p>
<ul>
<li>
<p>The device driver is the Microsoft-provided driver: WinUSB (Winusb.sys). That driver is included in the \Windows\System32\ folder.  For more information, see <a href="ff540283(v%3dvs.85)-2.html">WinUSB (Winusb.sys) Installation</a>.</p>
</li>
<li>
<p>You have previously obtained a WinUSB interface handle to device by calling <a href="ff540277(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_Initialize</strong></a>. All operations are performed by using that handle. Read <a href="ff540174(v%3dvs.85)-2.html">How to Access a USB Device by Using WinUSB Functions</a>.
</p>
</li>
<li>The active interface setting has isochronous endpoints. Otherwise, you cannot access the pipes for the target endpoints.</li>
</ul>
<h2><a id="Step_1__Find_the_isochronous_pipe_in_the_active_setting"></a><a id="step_1__find_the_isochronous_pipe_in_the_active_setting"></a><a id="STEP_1__FIND_THE_ISOCHRONOUS_PIPE_IN_THE_ACTIVE_SETTING"></a>Step 1: Find the isochronous pipe in the active setting</h2>
<ol>
<li>Get the USB interface that has the isochronous endpoints by calling <a href="ff540292(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_QueryInterfaceSettings</strong></a>. </li>
<li>Enumerate the pipes of the interface setting that defines the endpoints.</li>
<li>For each endpoint get the associated pipe properties in a  <a href="dn265570(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WINUSB_PIPE_INFORMATION_EX</strong></a> structure by calling <a href="dn265563(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_QueryPipeEx</strong></a>. The retrieved <strong>WINUSB_PIPE_INFORMATION_EX</strong> structure that contains information about the isochronous pipe. The structure contains information about the pipe, its type, id, and so on.</li>
<li>Check the structure members to determine whether it's the pipe that must be used for transfers. If it is, store the  <strong>PipeId</strong> value. In the template code, add members to the DEVICE_DATA structure, defined in Device.h.</li>
</ol>
<p>This example shows how to determine whether the active setting has isochronous endpoints and obtain information about them. In this example the device is a SuperMUTT device. The device has two isochronous endpoints in the default interface, alternate setting 1.</p>

<div id="code-snippet-1" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTabSingle" dir="ltr"><a>C++</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_5a299bf8-662a-4d02-bae0-49c34eacc4a0');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_5a299bf8-662a-4d02-bae0-49c34eacc4a0" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>



<span style="color:Blue;">typedef</span> <span style="color:Blue;">struct</span> _DEVICE_DATA {

    BOOL                    HandlesOpen;
    WINUSB_INTERFACE_HANDLE WinusbHandle;
    HANDLE                  DeviceHandle;
    TCHAR                   DevicePath[MAX_PATH];
    UCHAR                   IsochOutPipe;
    UCHAR                   IsochInPipe;

} DEVICE_DATA, *PDEVICE_DATA;

HRESULT
       GetIsochPipes(
       _Inout_ PDEVICE_DATA DeviceData
       )
{
       BOOL result;
       USB_INTERFACE_DESCRIPTOR usbInterface;
       WINUSB_PIPE_INFORMATION_EX pipe;
       HRESULT hr = S_OK;
       UCHAR i;

       result = WinUsb_QueryInterfaceSettings(DeviceData-&gt;WinusbHandle,
              0,
              &amp;usbInterface);

       <span style="color:Blue;">if</span> (result == FALSE)
       {
              hr = HRESULT_FROM_WIN32(GetLastError());
              printf(_T(<span style="color:#A31515;">"WinUsb_QueryInterfaceSettings failed to get USB interface.\n"</span>));
              CloseHandle(DeviceData-&gt;DeviceHandle);
              <span style="color:Blue;">return</span> hr;
       }

       <span style="color:Blue;">for</span> (i = 0; i &lt; usbInterface.bNumEndpoints; i++)
       {
              result = WinUsb_QueryPipeEx(
                     DeviceData-&gt;WinusbHandle,
                     1,
                     (UCHAR) i,
                     &amp;pipe);

              <span style="color:Blue;">if</span> (result == FALSE)
              {
                     hr = HRESULT_FROM_WIN32(GetLastError());
                     printf(_T(<span style="color:#A31515;">"WinUsb_QueryPipeEx failed to get USB pipe.\n"</span>));
                     CloseHandle(DeviceData-&gt;DeviceHandle);
                     <span style="color:Blue;">return</span> hr;
              }

              <span style="color:Blue;">if</span> ((pipe.PipeType == UsbdPipeTypeIsochronous) &amp;&amp; (!(pipe.PipeId == 0x80)))
              {
                     DeviceData-&gt;IsochOutPipe = pipe.PipeId;
              }
              <span style="color:Blue;">else</span> <span style="color:Blue;">if</span> (pipe.PipeType == UsbdPipeTypeIsochronous)
              {
                     DeviceData-&gt;IsochInPipe = pipe.PipeId;
              }
       }

       <span style="color:Blue;">return</span> hr;
}



</pre></div>
            
        </div>
    </div>
</div>

<p>The SuperMUTT device defines its isochronous endpoints in the default interface, at setting 1. The preceding code obtains the <strong>PipeId</strong> values and stores them in the DEVICE_DATA structure.</p>
<h2><a id="Step_2__Get_interval_information_about_the_isochronous_pipe"></a><a id="step_2__get_interval_information_about_the_isochronous_pipe"></a><a id="STEP_2__GET_INTERVAL_INFORMATION_ABOUT_THE_ISOCHRONOUS_PIPE"></a>Step 2: Get interval information about the isochronous pipe</h2>
<p>Next, get more information about the pipe that you obtained in call  to <a href="dn265563(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_QueryPipeEx</strong></a>. </p>
<ul>
<li><strong>Transfer size</strong><p>
</p><ol>
<li>From the retrieved <a href="dn265570(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WINUSB_PIPE_INFORMATION_EX</strong></a> structure, obtain the <strong>MaximumBytesPerInterval</strong> and <strong>Interval</strong> values.</li>
<li>Depending on the amount of isochronous data you want to send or receive, calculate the transfer size. For example, consider this calculation:<p><code> TransferSize = ISOCH_DATA_SIZE_MS * pipeInfoEx.MaximumBytesPerInterval * (8 / pipeInfoEx.Interval);  
          
</code></p>
<p>In the example, transfer size is calculated for 10 milliseconds of isochronous data.</p>
</li>
</ol>

</li>
<li><strong>Number of isochronous packets</strong>For example, consider this calculation:<p>To calculate the total number of isochronous packets required to hold the entire transfer. This information is required for read transfers and calculated as, <code>&gt;IsochInTransferSize / pipe.MaximumBytesPerInterval;  
          
</code>.</p>
</li>
</ul>
<p>This example shows add code to step 1 example and gets the interval values for the isochronous pipes.  </p>

<div id="code-snippet-2" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTabSingle" dir="ltr"><a>C++</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_1d4e42c0-e178-4e7c-800e-4fbebaeade09');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_1d4e42c0-e178-4e7c-800e-4fbebaeade09" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>



#define ISOCH_DATA_SIZE_MS   10

<span style="color:Blue;">typedef</span> <span style="color:Blue;">struct</span> _DEVICE_DATA {

    BOOL                    HandlesOpen;
    WINUSB_INTERFACE_HANDLE WinusbHandle;
    HANDLE                  DeviceHandle;
    TCHAR                   DevicePath[MAX_PATH];
				UCHAR                   IsochOutPipe;
				UCHAR                   IsochInPipe;
				ULONG                   IsochInTransferSize;
				ULONG                   IsochOutTransferSize;
				ULONG                   IsochInPacketCount;

} DEVICE_DATA, *PDEVICE_DATA;


...

<span style="color:Blue;">if</span> ((pipe.PipeType == UsbdPipeTypeIsochronous) &amp;&amp; (!(pipe.PipeId == 0x80)))
{
       DeviceData-&gt;IsochOutPipe = pipe.PipeId;

       <span style="color:Blue;">if</span> ((pipe.MaximumBytesPerInterval == 0) || (pipe.Interval == 0))
       {
	     hr = E_INVALIDARG;             
             printf(<span style="color:#A31515;">"Isoch Out: MaximumBytesPerInterval or Interval value is 0.\n"</span>);
             CloseHandle(DeviceData-&gt;DeviceHandle);
             <span style="color:Blue;">return</span> hr;
       }
       <span style="color:Blue;">else</span>
       {
             DeviceData-&gt;IsochOutTransferSize = 
                 ISOCH_DATA_SIZE_MS * 
                 pipe.MaximumBytesPerInterval *
                 (8 / pipe.Interval);
       }
}
<span style="color:Blue;">else</span> <span style="color:Blue;">if</span> (pipe.PipeType == UsbdPipeTypeIsochronous)
{
       DeviceData-&gt;IsochInPipe = pipe.PipeId;

       <span style="color:Blue;">if</span> (pipe.MaximumBytesPerInterval == 0 || (pipe.Interval == 0))
       {
	     hr = E_INVALIDARG;    
             printf(<span style="color:#A31515;">"Isoch Out: MaximumBytesPerInterval or Interval value is 0.\n"</span>);
             CloseHandle(DeviceData-&gt;DeviceHandle);
             <span style="color:Blue;">return</span> hr;
       }
       <span style="color:Blue;">else</span>
       {
             DeviceData-&gt;IsochInTransferSize = 
                 ISOCH_DATA_SIZE_MS * 
                 pipe.MaximumBytesPerInterval * 
                 (8 / pipe.Interval);

             DeviceData-&gt;IsochInPacketCount = 
                  DeviceData-&gt;IsochInTransferSize / pipe.MaximumBytesPerInterval;
       }
}

...





</pre></div>
            
        </div>
    </div>
</div>

<p>In the preceding code, the app gets <strong>Interval</strong> and <strong>MaximumBytesPerInterval</strong> from <a href="dn265570(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WINUSB_PIPE_INFORMATION_EX</strong></a> to calculate the transfer size and number of isochronous packets required for the read transfer. For both isochronous endpoints, <strong>Interval</strong> is 1. That value indicates that all microframes of the frame carry data. Based on that, to send 10 milliseconds of data, you need 10 frames, total transfer size is 10*1024*8 bytes and 80 isochronous packets, each 1024 bytes long.</p>
<h2><a id="Step_3__Send__a_write_transfer_to_send_data_to_an_isochronous_OUT_endpoint"></a><a id="step_3__send__a_write_transfer_to_send_data_to_an_isochronous_out_endpoint"></a><a id="STEP_3__SEND__A_WRITE_TRANSFER_TO_SEND_DATA_TO_AN_ISOCHRONOUS_OUT_ENDPOINT"></a>Step 3: Send  a write transfer to send data to an isochronous OUT endpoint</h2>
<p>This procedure summarizes the steps for writing data to an isochronous endpoint. </p><ol>
<li>Allocate a buffer that contains the data to send.</li>
<li>If you are sending the data asynchronously, allocate and initialize an <a href="bb773368(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">OVERLAPPED</strong></a> structure that contains a handle to a caller-allocated event object. The structure must be initialized to zero, otherwise the call fails.</li>
<li>Register the buffer by calling <a href="dn265566(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_RegisterIsochBuffer</strong></a>. </li>
<li>Start the transfer by calling <a href="dn265569(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_WriteIsochPipeAsap</strong></a>. If you want to manually specify the frame in which data will be transferred, call <a href="dn265568(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_WriteIsochPipe</strong></a> instead.</li>
<li>Get results of the transfer by calling <a href="ff540263(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_GetOverlappedResult</strong></a>.</li>
<li>When finished, release the buffer handle by calling  <a href="dn265567(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_UnregisterIsochBuffer</strong></a>, the overlapped event handle, and the transfer buffer.</li>
</ol>

<p>Here is an example that shows how to send a write transfer. </p>

<div id="code-snippet-3" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTabSingle" dir="ltr"><a>C++</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_2cecad82-e86c-474d-83a4-f1125380fbeb');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_2cecad82-e86c-474d-83a4-f1125380fbeb" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>


#define ISOCH_TRANSFER_COUNT   3

VOID
    SendIsochOutTransfer(
    _Inout_ PDEVICE_DATA DeviceData,
    _In_ BOOL AsapTransfer
    )
{
    PUCHAR writeBuffer;
    LPOVERLAPPED overlapped;
    ULONG numBytes;
    BOOL result;
    DWORD lastError;
    WINUSB_ISOCH_BUFFER_HANDLE isochWriteBufferHandle;
    ULONG frameNumber;
    ULONG startFrame;
    LARGE_INTEGER timeStamp;
    ULONG i;
    ULONG totalTransferSize;

    isochWriteBufferHandle = INVALID_HANDLE_VALUE;
    writeBuffer = NULL;
    overlapped = NULL;

    printf(_T(<span style="color:#A31515;">"\n\nWrite transfer.\n"</span>));

    totalTransferSize = DeviceData-&gt;IsochOutTransferSize * ISOCH_TRANSFER_COUNT;

    <span style="color:Blue;">if</span> (totalTransferSize % DeviceData-&gt;IsochOutBytesPerFrame != 0)
    {
        printf(_T(<span style="color:#A31515;">"Transfer size must end at a frame boundary.\n"</span>));
        <span style="color:Blue;">goto</span> Error;
    }
    
    writeBuffer = <span style="color:Blue;">new</span> UCHAR[totalTransferSize];

    <span style="color:Blue;">if</span> (writeBuffer == NULL)
    {
        printf(_T(<span style="color:#A31515;">"Unable to allocate memory.\n"</span>));
        <span style="color:Blue;">goto</span> Error;
    }

    ZeroMemory(writeBuffer, totalTransferSize);

    overlapped = <span style="color:Blue;">new</span> OVERLAPPED[ISOCH_TRANSFER_COUNT];
    <span style="color:Blue;">if</span> (overlapped == NULL)
    {
        printf(<span style="color:#A31515;">"Unable to allocate memory.\n"</span>);
        <span style="color:Blue;">goto</span> Error;

    }

    ZeroMemory(overlapped, (<span style="color:Blue;">sizeof</span>(OVERLAPPED) * ISOCH_TRANSFER_COUNT));

    <span style="color:Blue;">for</span> (i = 0; i &lt; ISOCH_TRANSFER_COUNT; i++)
    {
        overlapped[i].hEvent = CreateEvent(NULL, TRUE, FALSE, NULL);

        <span style="color:Blue;">if</span> (overlapped[i].hEvent == NULL)
        {
            printf(<span style="color:#A31515;">"Unable to set event for overlapped operation.\n"</span>);
            <span style="color:Blue;">goto</span> Error;

        }
    }

    result = WinUsb_RegisterIsochBuffer(
        DeviceData-&gt;WinusbHandle,
        DeviceData-&gt;IsochOutPipe,
        writeBuffer,
        totalTransferSize,
        &amp;isochWriteBufferHandle);

    <span style="color:Blue;">if</span> (!result)
    {
        printf(_T(<span style="color:#A31515;">"Isoch buffer registration failed.\n"</span>));
        <span style="color:Blue;">goto</span> Error;
    }

    result = WinUsb_GetCurrentFrameNumber(
                DeviceData-&gt;WinusbHandle,
                &amp;frameNumber,
                &amp;timeStamp);

    <span style="color:Blue;">if</span> (!result)
    {
        printf(_T(<span style="color:#A31515;">"WinUsb_GetCurrentFrameNumber failed.\n"</span>));
        <span style="color:Blue;">goto</span> Error;
    }

    startFrame = frameNumber + 5;

    <span style="color:Blue;">for</span> (i = 0; i &lt; ISOCH_TRANSFER_COUNT; i++)
    {

        <span style="color:Blue;">if</span> (AsapTransfer)
        {
            result = WinUsb_WriteIsochPipeAsap(
                isochWriteBufferHandle,
                DeviceData-&gt;IsochOutTransferSize * i,
                DeviceData-&gt;IsochOutTransferSize,
                (i == 0) ? FALSE : TRUE,
                &amp;overlapped[i]);

            printf(_T(<span style="color:#A31515;">"Write transfer sent by using ASAP flag.\n"</span>));
        }
        <span style="color:Blue;">else</span>
        {

            printf(<span style="color:#A31515;">"Transfer starting at frame %d.\n"</span>, startFrame);

            result = WinUsb_WriteIsochPipe(
                isochWriteBufferHandle,
                i * DeviceData-&gt;IsochOutTransferSize,
                DeviceData-&gt;IsochOutTransferSize,
                &amp;startFrame,
                &amp;overlapped[i]);

            printf(<span style="color:#A31515;">"Next transfer frame %d.\n"</span>, startFrame);

        }

        <span style="color:Blue;">if</span> (!result)
        {
            lastError = GetLastError();

            <span style="color:Blue;">if</span> (lastError != ERROR_IO_PENDING)
            {
                printf(<span style="color:#A31515;">"Failed to send write transfer with error %x\n"</span>, lastError);
            }
        }
    }

    <span style="color:Blue;">for</span> (i = 0; i &lt; ISOCH_TRANSFER_COUNT; i++)
    {
        result = WinUsb_GetOverlappedResult(
            DeviceData-&gt;WinusbHandle,
            &amp;overlapped[i],
            &amp;numBytes,
            TRUE);

        <span style="color:Blue;">if</span> (!result)
        {
            lastError = GetLastError();

            printf(<span style="color:#A31515;">"Write transfer %d with error %x\n"</span>, i, lastError);
        }
        <span style="color:Blue;">else</span>
        {
            printf(<span style="color:#A31515;">"Write transfer %d completed. \n"</span>, i);

        }
    }




Error:
    <span style="color:Blue;">if</span> (isochWriteBufferHandle != INVALID_HANDLE_VALUE)
    {
        result = WinUsb_UnregisterIsochBuffer(isochWriteBufferHandle);
        <span style="color:Blue;">if</span> (!result)
        {
            printf(_T(<span style="color:#A31515;">"Failed to unregister isoch write buffer. \n"</span>));
        }
    }

    <span style="color:Blue;">if</span> (writeBuffer != NULL)
    {
        <span style="color:Blue;">delete</span> [] writeBuffer;
    }

    <span style="color:Blue;">for</span> (i = 0; i &lt; ISOCH_TRANSFER_COUNT; i++)
    {
        <span style="color:Blue;">if</span> (overlapped[i].hEvent != NULL)
        {
            CloseHandle(overlapped[i].hEvent);
        }

    }

    <span style="color:Blue;">if</span> (overlapped != NULL)
    {
        <span style="color:Blue;">delete</span> [] overlapped;
    }


    <span style="color:Blue;">return</span>;
}



</pre></div>
            
        </div>
    </div>
</div>

<h2><a id="Step_4__Send__a_read_transfer_to_receive_data_from_an_isochronous_IN_endpoint"></a><a id="step_4__send__a_read_transfer_to_receive_data_from_an_isochronous_in_endpoint"></a><a id="STEP_4__SEND__A_READ_TRANSFER_TO_RECEIVE_DATA_FROM_AN_ISOCHRONOUS_IN_ENDPOINT"></a>Step 4: Send  a read transfer to receive data from an isochronous IN endpoint</h2>
<p>This procedure summarizes the steps for reading data from an isochronous endpoint. </p><ol>
<li>Allocate a transfer buffer that will receive data at the end of the transfer. The size of the buffer must be based on the transfer size calculate in step 2. The transfer buffer must end at a frame boundary.</li>
<li>If you are sending the data asynchronously, allocate an <a href="bb773368(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">OVERLAPPED</strong></a> structure that contains a handle to a caller-allocated event object. The structure must be initialized to zero, otherwise the call fails.</li>
<li>Register the buffer by calling <a href="dn265566(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_RegisterIsochBuffer</strong></a>.</li>
<li>Based on the number isochronous packets calculated in step 2, allocate an array of isochronous packets (<a href="ff539084(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">USBD_ISO_PACKET_DESCRIPTOR</strong></a>).</li>
<li>Start the transfer by calling <a href="dn265565(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_ReadIsochPipeAsap</strong></a>. If you want to manually specify the start frame in which data will be transferred, call <a href="dn265564(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_ReadIsochPipe</strong></a> instead. </li>
<li>Get results of the transfer by calling <a href="ff540263(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_GetOverlappedResult</strong></a>.</li>
<li>When finished, release the buffer handle by calling  <a href="dn265567(v%3dvs.85)-2.html"><strong xmlns="http://www.w3.org/1999/xhtml">WinUsb_UnregisterIsochBuffer</strong></a>, the overlapped event handle, the array of isochronous packets, and the transfer buffer.</li>
</ol>

<p>Here is an example that shows how to send a read transfer by calling WinUsb_ReadIsochPipeAsap and WinUsb_ReadIsochPipe. </p>

<div id="code-snippet-4" class="codeSnippetContainer" xmlns="">
    <div class="codeSnippetContainerTabs">
        <div class="codeSnippetContainerTabSingle" dir="ltr"><a>C++</a></div>
    </div>
    <div class="codeSnippetContainerCodeContainer">
        <div class="codeSnippetToolBar">
            <div class="codeSnippetToolBarText">
                <a name="CodeSnippetCopyLink" style="display: none;" title="Copy to clipboard." href="javascript:if (window.epx.codeSnippet)window.epx.codeSnippet.copyCode('CodeSnippetContainerCode_180685d9-ae32-4095-8572-9b87e646f0c9');">Copy</a>
            </div>
        </div>
        <div id="CodeSnippetContainerCode_180685d9-ae32-4095-8572-9b87e646f0c9" class="codeSnippetContainerCode" dir="ltr">
            <div style="color:Black;"><pre>


#define ISOCH_TRANSFER_COUNT   3

VOID
    SendIsochInTransfer(
    _Inout_ PDEVICE_DATA DeviceData,
    _In_ BOOL AsapTransfer
    )
{
    PUCHAR readBuffer;
    LPOVERLAPPED overlapped;
    ULONG numBytes;
    BOOL result;
    DWORD lastError;
    WINUSB_ISOCH_BUFFER_HANDLE isochReadBufferHandle;
    PUSBD_ISO_PACKET_DESCRIPTOR isochPackets;
    ULONG i;
    ULONG j;

    ULONG frameNumber;
    ULONG startFrame;
    LARGE_INTEGER timeStamp;

    ULONG totalTransferSize;

    readBuffer = NULL;
    isochPackets = NULL;
    overlapped = NULL;
    isochReadBufferHandle = INVALID_HANDLE_VALUE;

    printf(_T(<span style="color:#A31515;">"\n\nRead transfer.\n"</span>));

    totalTransferSize = DeviceData-&gt;IsochOutTransferSize * ISOCH_TRANSFER_COUNT;

    <span style="color:Blue;">if</span> (totalTransferSize % DeviceData-&gt;IsochOutBytesPerFrame != 0)
    {
        printf(_T(<span style="color:#A31515;">"Transfer size must end at a frame boundary.\n"</span>));
        <span style="color:Blue;">goto</span> Error;
    }

    readBuffer = <span style="color:Blue;">new</span> UCHAR[totalTransferSize];

    <span style="color:Blue;">if</span> (readBuffer == NULL)
    {
        printf(_T(<span style="color:#A31515;">"Unable to allocate memory.\n"</span>));
        <span style="color:Blue;">goto</span> Error;
    }

    ZeroMemory(readBuffer, totalTransferSize);

    overlapped = <span style="color:Blue;">new</span> OVERLAPPED[ISOCH_TRANSFER_COUNT];
    ZeroMemory(overlapped, (<span style="color:Blue;">sizeof</span>(OVERLAPPED) * ISOCH_TRANSFER_COUNT));

    <span style="color:Blue;">for</span> (i = 0; i &lt; ISOCH_TRANSFER_COUNT; i++)
    {
        overlapped[i].hEvent = CreateEvent(NULL, TRUE, FALSE, NULL);

        <span style="color:Blue;">if</span> (overlapped[i].hEvent == NULL)
        {
            printf(<span style="color:#A31515;">"Unable to set event for overlapped operation.\n"</span>);
            <span style="color:Blue;">goto</span> Error;
        }
    }

    isochPackets = <span style="color:Blue;">new</span> USBD_ISO_PACKET_DESCRIPTOR[DeviceData-&gt;IsochInPacketCount * ISOCH_TRANSFER_COUNT];
    ZeroMemory(isochPackets, DeviceData-&gt;IsochInPacketCount * ISOCH_TRANSFER_COUNT);

    result = WinUsb_RegisterIsochBuffer(
        DeviceData-&gt;WinusbHandle,
        DeviceData-&gt;IsochInPipe,
        readBuffer,
        DeviceData-&gt;IsochInTransferSize * ISOCH_TRANSFER_COUNT,
        &amp;isochReadBufferHandle);

    <span style="color:Blue;">if</span> (!result)
    {
        printf(_T(<span style="color:#A31515;">"Isoch buffer registration failed.\n"</span>));
        <span style="color:Blue;">goto</span> Error;
    }
            
    result = WinUsb_GetCurrentFrameNumber(
                DeviceData-&gt;WinusbHandle,
                &amp;frameNumber,
                &amp;timeStamp);

    <span style="color:Blue;">if</span> (!result)
    {
        printf(_T(<span style="color:#A31515;">"WinUsb_GetCurrentFrameNumber failed.\n"</span>));
        <span style="color:Blue;">goto</span> Error;
    }

    startFrame = frameNumber + 5;

    <span style="color:Blue;">for</span> (i = 0; i &lt; ISOCH_TRANSFER_COUNT; i++)
    {
        <span style="color:Blue;">if</span> (AsapTransfer)
        {
            result = WinUsb_ReadIsochPipeAsap(
                isochReadBufferHandle,
                DeviceData-&gt;IsochInTransferSize * i,
                DeviceData-&gt;IsochInTransferSize,
                (i == 0) ? FALSE : TRUE,
                DeviceData-&gt;IsochInPacketCount,
                &amp;isochPackets[i * DeviceData-&gt;IsochInPacketCount],
                &amp;overlapped[i]);

            printf(_T(<span style="color:#A31515;">"Read transfer sent by using ASAP flag.\n"</span>));

        }
        <span style="color:Blue;">else</span>
        {

            printf(<span style="color:#A31515;">"Transfer starting at frame %d.\n"</span>, startFrame);

            result = WinUsb_ReadIsochPipe(
                isochReadBufferHandle,
                DeviceData-&gt;IsochInTransferSize * i,
                DeviceData-&gt;IsochInTransferSize,
                &amp;startFrame,
                DeviceData-&gt;IsochInPacketCount,
                &amp;isochPackets[i * DeviceData-&gt;IsochInPacketCount],
                &amp;overlapped[i]);

            printf(<span style="color:#A31515;">"Next transfer frame %d.\n"</span>, startFrame);

        }

        <span style="color:Blue;">if</span> (!result)
        {
            lastError = GetLastError();

            <span style="color:Blue;">if</span> (lastError != ERROR_IO_PENDING)
            {
                printf(<span style="color:#A31515;">"Failed to start a read operation with error %x\n"</span>, lastError);
            }
        }
    }

    <span style="color:Blue;">for</span> (i = 0; i &lt; ISOCH_TRANSFER_COUNT; i++)
    {
        result = WinUsb_GetOverlappedResult(
            DeviceData-&gt;WinusbHandle,
            &amp;overlapped[i],
            &amp;numBytes,
            TRUE);

        <span style="color:Blue;">if</span> (!result)
        {
            lastError = GetLastError();

            printf(<span style="color:#A31515;">"Failed to read with error %x\n"</span>, lastError);
        }
        <span style="color:Blue;">else</span>
        {
            numBytes = 0;
            <span style="color:Blue;">for</span> (j = 0; j &lt; DeviceData-&gt;IsochInPacketCount; j++)
            {
                numBytes += isochPackets[j].Length;
            }

            printf(<span style="color:#A31515;">"Requested %d bytes in %d packets per transfer.\n"</span>, DeviceData-&gt;IsochInTransferSize, DeviceData-&gt;IsochInPacketCount);
        }

        printf(<span style="color:#A31515;">"Transfer %d completed. Read %d bytes. \n\n"</span>, i+1, numBytes);
    }



Error:
    <span style="color:Blue;">if</span> (isochReadBufferHandle != INVALID_HANDLE_VALUE)
    {
        result = WinUsb_UnregisterIsochBuffer(isochReadBufferHandle);
        <span style="color:Blue;">if</span> (!result)
        {
            printf(_T(<span style="color:#A31515;">"Failed to unregister isoch read buffer. \n"</span>));
        }
    }    
    
    <span style="color:Blue;">if</span> (readBuffer != NULL)
    {
        <span style="color:Blue;">delete</span> [] readBuffer;
    }

    <span style="color:Blue;">if</span> (isochPackets != NULL)
    {
        <span style="color:Blue;">delete</span> [] isochPackets;
    }

    <span style="color:Blue;">for</span> (i = 0; i &lt; ISOCH_TRANSFER_COUNT; i++)

    {
        <span style="color:Blue;">if</span> (overlapped[i].hEvent != NULL)
        {
            CloseHandle(overlapped[i].hEvent);
        }

    }

    <span style="color:Blue;">if</span> (overlapped != NULL)
    {
        <span style="color:Blue;">delete</span> [] overlapped;
    }
    <span style="color:Blue;">return</span>;
}




</pre></div>
            
        </div>
    </div>
</div>

<h2><a id="related_topics"></a>Related topics</h2>
<dl>
<dt>
<a href="ff540174(v%3dvs.85)-2.html">How to Access a USB Device by Using WinUSB Functions</a>
</dt>
<dt>
<a href="ff540174(v%3dvs.85)-2.html">WinUSB Functions</a>
</dt>
</dl>
<p> </p>
<p> </p>
<p><a href="mailto:wsddocfb@microsoft.com?subject=Documentation%20feedback [usbcon\buses]:%20Send USB isochronous transfers from a WinUSB desktop app%20 RELEASE:%20(2/20/2014)&amp;body=%0A%0APRIVACY STATEMENT%0A%0AWe use your feedback to improve the documentation. We don't use your email address for any other purpose, and we'll remove your email address from our system after the issue that you're reporting is fixed. While we're working to fix this issue, we might send you an email message to ask for more info. Later, we might also send you an email message to let you know that we've addressed your feedback.%0A%0AFor more info about Microsoft's privacy policy, see http://privacy.microsoft.com/en-us/default.aspx." title="Send comments about this topic to Microsoft">Send comments about this topic to Microsoft</a></p>
</div>
</div>

    




<div class="libraryMemberFilter">
    <div class="filterContainer">
        <span>Show:</span>
        <label>
            <input type="checkbox" class="libraryFilterInherited" checked="checked" value="Inherit" />Inherited
        </label>
        <label>
            <input type="checkbox" class="libraryFilterProtected" checked="checked" value="Protected" />Protected
        </label>
    </div>
</div>
    
<input type="hidden" id="libraryMemberFilterEmptyWarning" value="There are no members available with your current filter settings." />


 
</div>




            </div>
            <div class="clear"></div>
        
            
    
<input name="__RequestVerificationToken" type="hidden" value="tUXnBAYzMeF3Qam--XCliokrZm4C2EFwXW3IMjWMVM0d3wifX4n1WvbDQhwAcK46EQNYd2N_giDuc4yHYfyP_Q2LFB_TnBhWtS_AaDM6h0V2eEa_Cq4b_WvtWtrlIGf2_PV2Gw2" />
<input id="ratingSubmitUrl" type="hidden" value="http://msdn.microsoft.com/en-US/library/feedback/add/dn376866(v=vs.85).aspx" />
<input id="isTopicRated" type="hidden" value="false" />




    


    <div id="ux-footer" class=" ltr">
        
            <div id="footerSock">
                <div id="footerSockInner">
                    <a name="feedback"></a>
                    <div data-fragmentName="Survey" id="Fragment_Survey" xmlns="http://www.w3.org/1999/xhtml">
  <div class="DetailedLink">
    
    <div class="Content"></div>
  </div>
</div>
<div class="rating">
    <div id="ratingSection1">
        <div class="title">
            Was this page helpful?
        </div>
        <div class="description">
            Your feedback about this content is important.<br />Let us know what you think.
        </div>
        <div class="buttons">
            <button id="ratingYes">Yes</button>
            <button id="ratingNo">No</button>
        </div>
        <input id="ratingValue" type="hidden" value="" />
    </div>
    <div id="ratingSection2">
        <div class="title">
            Additional feedback?
        </div>
        <textarea id="ratingText" rows="6" cols=""></textarea>
        <div class="buttons">
            <button id="ratingSubmit">Submit</button>
            <button id="ratingSkipThis">Skip this</button>
        </div>
    </div>
    <div id="ratingSection3">
        <div class="title">
            Thank you!
        </div>
        <div class="description">
            We appreciate your feedback.
        </div>
    </div>
    
    
    <div id="contentFeedbackQAContainer" style="display: none;"></div>
</div>


                    <div data-fragmentName="SockLinks" id="Fragment_SockLinks" xmlns="http://www.w3.org/1999/xhtml">
  
  <div class="LinkList">
    <div class="Links">
      <ul class="LinkColumn" style="width: 100%">
        <li>
          <a href="../../../../../go.microsoft.com/fwlink/p/indexbdd5.html?LinkId=317805" id="SockLinks_727_11" xmlns="http://www.w3.org/1999/xhtml">Find us on Facebook</a>
        </li>
        <li>
          <a href="../../../../../go.microsoft.com/fwlink/p/index00a1.html?LinkId=317806" id="SockLinks_727_12" xmlns="http://www.w3.org/1999/xhtml">Follow us on Twitter</a>
        </li>
        <li>
          <a href="../../../../../go.microsoft.com/fwlink/p/indexbae3.html?linkid=285656" id="SockLinks_727_40" xmlns="http://www.w3.org/1999/xhtml">Read the hardware blog</a>
        </li>
      </ul>
    </div>
  </div>
</div>
                    <div class="clear"></div>
                </div>
            </div>
        <div id="footerContainer">
            <div id="fourColumnFooter">
                <div data-fragmentName="Column1" id="Fragment_Column1" xmlns="http://www.w3.org/1999/xhtml">
  <div class="ListOfLinkLists">
    
    <div class="LinkList" xmlns="http://www.w3.org/1999/xhtml">
      <div class="LinkListTitle">Centers</div>
      <div class="Links">
        <ul class="LinkColumn" style="width: 100%">
          <li>
            <a href="http://msdn.microsoft.com/windows" id="Column1_727_13" xmlns="http://www.w3.org/1999/xhtml">Dev Center Home</a>
          </li>
          <li>
            <a href="http://msdn.microsoft.com/windows/apps" id="Column1_727_14" xmlns="http://www.w3.org/1999/xhtml">Windows Store apps</a>
          </li>
          <li>
            <a href="http://msdn.microsoft.com/ie" id="Column1_727_15" xmlns="http://www.w3.org/1999/xhtml">Internet Explorer</a>
          </li>
          <li>
            <a href="http://msdn.microsoft.com/windows/desktop" id="Column1_727_16" xmlns="http://www.w3.org/1999/xhtml">Desktop</a>
          </li>
          <li>
            <a href="http://msdn.microsoft.com/windows/hardware" id="Column1_727_17" xmlns="http://www.w3.org/1999/xhtml">Hardware</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>              
                <div data-fragmentName="Column2" id="Fragment_Column2" xmlns="http://www.w3.org/1999/xhtml">
  <div class="ListOfLinkLists">
    
    <div class="LinkList" xmlns="http://www.w3.org/1999/xhtml">
      <div class="LinkListTitle">Related developer sites</div>
      <div class="Links">
        <ul class="LinkColumn" style="width: 100%">
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285634" id="Column2_727_18" xmlns="http://www.w3.org/1999/xhtml">Microsoft Connect</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285635" id="Column2_727_19" xmlns="http://www.w3.org/1999/xhtml">OSR Online</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=282089" id="Column2_727_42" xmlns="http://www.w3.org/1999/xhtml">Visual Studio</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=280293" id="Column2_727_20" xmlns="http://www.w3.org/1999/xhtml">Windows Phone</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=282087" id="Column2_727_43" xmlns="http://www.w3.org/1999/xhtml">Windows Server</a>
          </li>
        </ul>
      </div>
    </div>
    
    <div class="LinkList" xmlns="http://www.w3.org/1999/xhtml">
      <div class="LinkListTitle">Other Windows sites</div>
      <div class="Links">
        <ul class="LinkColumn" style="width: 100%">
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285636" id="Column2_727_21" xmlns="http://www.w3.org/1999/xhtml">Enterprise</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285637" id="Column2_727_22" xmlns="http://www.w3.org/1999/xhtml">Small business</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285638" id="Column2_727_23" xmlns="http://www.w3.org/1999/xhtml">Students</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285639" id="Column2_727_24" xmlns="http://www.w3.org/1999/xhtml">Home users</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>              
                <div data-fragmentName="Column3" id="Fragment_Column3" xmlns="http://www.w3.org/1999/xhtml">
  <div class="ListOfLinkLists">
    
    <div class="LinkList" xmlns="http://www.w3.org/1999/xhtml">
      <div class="LinkListTitle">Downloads</div>
      <div class="Links">
        <ul class="LinkColumn" style="width: 100%">
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285645" id="Column3_727_25" xmlns="http://www.w3.org/1999/xhtml">Windows Driver Kit</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285646" id="Column3_727_26" xmlns="http://www.w3.org/1999/xhtml">Windows Assessment and Deployment Kit</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285647" id="Column3_727_27" xmlns="http://www.w3.org/1999/xhtml">Windows Hardware Certification Kit</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?LinkID=316548" id="Column3_727_29" xmlns="http://www.w3.org/1999/xhtml">Visual Studio Professional 2013</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285649" id="Column3_727_30" xmlns="http://www.w3.org/1999/xhtml">More downloads</a>
          </li>
        </ul>
      </div>
    </div>
    
    <div class="LinkList" xmlns="http://www.w3.org/1999/xhtml">
      <div class="LinkListTitle">Support</div>
      <div class="Links">
        <ul class="LinkColumn" style="width: 100%">
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285664" id="Column3_727_44" xmlns="http://www.w3.org/1999/xhtml">Forums</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285663" id="Column3_727_45" xmlns="http://www.w3.org/1999/xhtml">More support options</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>              
                <div data-fragmentName="Column4" id="Fragment_Column4" xmlns="http://www.w3.org/1999/xhtml">
  <div class="ListOfLinkLists">
    
    <div class="LinkList" xmlns="http://www.w3.org/1999/xhtml">
      <div class="LinkListTitle">Essentials</div>
      <div class="Links">
        <ul class="LinkColumn" style="width: 100%">
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285650" id="Column4_727_46" xmlns="http://www.w3.org/1999/xhtml">Recently published</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285651" id="Column4_727_47" xmlns="http://www.w3.org/1999/xhtml">Debugging</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=328186" id="Column4_727_48" xmlns="http://www.w3.org/1999/xhtml">Samples</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285653" id="Column4_727_49" xmlns="http://www.w3.org/1999/xhtml">Hardware dashboard</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=317804" id="Column4_727_50" xmlns="http://www.w3.org/1999/xhtml">Partner with Microsoft</a>
          </li>
        </ul>
      </div>
    </div>
    
    <div class="LinkList" xmlns="http://www.w3.org/1999/xhtml">
      <div class="LinkListTitle">Stay connected</div>
      <div class="Links">
        <ul class="LinkColumn" style="width: 100%">
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=285658" id="Column4_727_36" xmlns="http://www.w3.org/1999/xhtml">Microsoft events</a>
          </li>
          <li>
            <a href="http://go.microsoft.com/fwlink/p/?linkid=313299" id="Column4_727_37" xmlns="http://www.w3.org/1999/xhtml">Windows App Builder Blog</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>              
            </div>

            <div id="baseFooterLogos">
                <span class="microsoftlogo" title="Microsoft"></span>
                <a href="http://msdn.microsoft.com/en-US" class="msdnlogo" title="MSDN"></a>
            </div>
        
            <div id="baseFooter">
                <div id="FooterCopyright">© 2014 Microsoft</div>
                <div data-fragmentName="BaseFooterContent" id="Fragment_BaseFooterContent" xmlns="http://www.w3.org/1999/xhtml">
  <div xmlns="http://www.w3.org/1999/xhtml">
    <div xmlns:mtps="http://msdn2.microsoft.com/mtps">
      <div data-fragmentName="BaseFooter" id="Fragment_BaseFooter">
        
        <div class="LinkList">
          <div class="Links">
            <ul class="LinkColumn horizontal">
              <li>
                <a href="http://msdn.microsoft.com/windows/apps/cc300389" id="BaseFooter_35351_1" xmlns="http://www.w3.org/1999/xhtml">Terms of Use</a>
              </li>
              <li>
                <a href="http://www.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx" id="BaseFooter_35351_2" xmlns="http://www.w3.org/1999/xhtml">Trademarks</a>
              </li>
              <li>
                <a href="http://www.microsoft.com/info/privacy.mspx" id="BaseFooter_35351_3" xmlns="http://www.w3.org/1999/xhtml">Privacy and Cookies</a>
              </li>
              <li>
                <a href="http://msdn.microsoft.com/en-US/windows/dn554289" id="BaseFooter_730_5" xmlns="http://www.w3.org/1999/xhtml">Site map</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div data-fragmentName="HelloText" id="Fragment_HelloText">Hello from Seattle.
</div>
    </div>
  </div>
</div>  
                    <form class="selectLocale" id="selectLocaleForm" action="http://msdn.microsoft.com/en-US/windows/hardware/SelectLocale">
        <input type="hidden" name="fromPage" value="http%3a%2f%2fmsdn.microsoft.com%2fen-US%2flibrary%2fwindows%2fhardware%2fdn376866(v%3dvs.85).aspx" />
        <a href="#" onclick="$('#selectLocaleForm').submit();return false;" title="Change your language">United States (English)</a>
    </form>    


                <div class="clear"></div>
            </div>
        </div>
    </div> 


            <div class="footerPrintView">
                <div class="footerCopyrightPrintView">© 2014 Microsoft. All rights reserved.</div>
            </div>

            
            
    


        
            <input id="MtpsDevice" type="hidden" value="Default" />


<![CDATA[ Third party scripts and code linked to or referenced from this website are licensed to you by the parties that own such code, not by Microsoft.  See ASP.NET Ajax CDN Terms of Use – http://www.asp.net/ajaxlibrary/CDN.ashx. ]]>
        
            
            
            
            
            
        





<noscript><div><img alt="DCSIMG" id="Img1" width="1" height="1" src="../../../../../m.webtrends.com/dcsmgru7m99k7mqmgrhudo0k8_8c6m/njsb803.html?dcsuri=/nojavascript&amp;WT.js=No" /></div></noscript>









<noscript>
  <a href="http://www.omniture.com/" title="Web Analytics">
    <img src="http://msstonojsmsdn.112.2o7.net/b/ss/msstonojsmsdn/1/H.20.2--NS/0" height="1" width="1" border="0" alt="" />
  </a>
</noscript>




<div id="globalRequestVerification">
    <input name="__RequestVerificationToken" type="hidden" value="7NSpPyCBPS_9NXcbhZwdgw_bBguu3rkqqXUnoNYwcLryIvw5at1AleLC7LxS9PaGOu6NmRwz0fjB_8gp4WFV2HzcOx_oq4l9nXD0xwM3xHlOTaJfdKpfU2sk_bUcTDcnXjBYmQ2" />
</div>


        </div>
    <script type="text/javascript" class="mtps-injected">
/*<![CDATA[*/
(function(window,document){"use strict";function preload(scripts){for(var result=[],script,e,i=0;i<scripts.length;i++)script=scripts[i],script.hasOwnProperty("url")&&(e=document.createElement("script"),e.src=script.url,script.throwaway=e),result.push(script);return result}function inject(scripts,index){var script,elem;if(index>=scripts.length){delete mtps.injectScripts;return}script=scripts[index];elem=document.createElement("script");elem.className="mtps-injected";elem.async=!1;var isLoaded=!1,timeoutId=0,injectNextFnName="",injectNext=elem.onerror=function(){isLoaded||(isLoaded=!0,inject(scripts,index+1),window.clearTimeout(timeoutId),elem.onload=elem.onerror=elem.onreadystatechange=null,injectNextFnName&&delete mtps[injectNextFnName],elem.removeEventListener&&elem.removeEventListener("load",injectNext,!1))};elem.addEventListener?elem.addEventListener("load",injectNext,!1):elem.readyState==="uninitialized"?elem.onreadystatechange=function(){(this.readyState==="loaded"||this.readyState==="complete")&&injectNext()}:elem.onload=injectNext;script.hasOwnProperty("url")?(timeoutId=window.setTimeout(injectNext,12e4),elem.src=script.url):(injectNextFnName="_injectNextScript_"+index,mtps[injectNextFnName]=injectNext,timeoutId=window.setTimeout(injectNext,2e3),elem.text="try {\n"+script.txt+"\n} finally { MTPS."+injectNextFnName+" && MTPS."+injectNextFnName+"(); }");parent.appendChild(elem)}var mtps=window.MTPS||(window.MTPS={}),parent=document.getElementsByTagName("head")[0];mtps.injectScripts=function(scripts){inject(preload(scripts),0)}})(window,document);
MTPS.injectScripts([
	{ txt: "/**/\r\n(window.MTPS || (window.MTPS = {})).cdnDomains || (window.MTPS.cdnDomains = { \r\n\t\"image\": \"http://i.msdn.microsoft.com\", \r\n\t\"js\": \"http://i2.msdn.microsoft.com\", \r\n\t\"css\": \"http://i3.msdn.microsoft.com\"\r\n});\r\n/**/" },
	{ url: "http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.8.2.min.js" },
	{ txt: "//\n  var literalNormalizedUrl = \u0027/en-us/library/windows/hardware/dn376866(d=default,l=en-us,v=vs.85).aspx\u0027;\n  var wt_nvr_ru = \u0027WT_NVR_RU\u0027;\n  var wt_fpcdom = \u0027.microsoft.com\u0027;\n  var wt_domlist = \u0027msdn.microsoft.com\u0027;\n  var wt_pathlist = \u0027\u0027;\n  var wt_paramlist = \u0027DCSext.mtps_devcenter\u0027;\n  var wt_siteid = \u0027MSDN\u0027;\n  var gDomain = \u0027m.webtrends.com\u0027;\n  var gDcsId = \u0027dcsmgru7m99k7mqmgrhudo0k8_8c6m\u0027;\n  var gFpc = \u0027WT_FPC\u0027;\n\n\n\n  if (document.cookie.indexOf(gFpc + \"=\") == -1) {\n    var wtidJs = document.createElement(\"script\");\n    wtidJs.src = \"//\" + gDomain + \"/\" + gDcsId + \"/wtid.js\";\n    document.getElementsByTagName(\"head\")[0].appendChild(wtidJs);\n  }\n\n\n\n  var detectedLocale = \u0027en-US\u0027;\n  var wtsp = \u0027_msdn_\u0027;\n  var gTrackEvents = \u00270\u0027;\n/**/" },
	{ txt: "/**/\n  var omni_guid = \"ed4bb5e8-e7ac-41c8-8bb2-ff315068bdd8\";\n/**/" },
	{ url: "http://i2.msdn.microsoft.com/Combined.js?resources=0:Utilities,0:Topic,1:webtrendsscript,2:omni_rsid_MSDN,3:SearchBox;/Areas/Epx/Content/Scripts:0,/Areas/Global/Content/Webtrends/resources:1,/Areas/Global/Content/Omniture/resources/MSDN:2,/Areas/Epx/Themes/Base/Content:3\u0026amp;hashKey=E93F43E708C4E79B13014A098239D120" },
	{ url: "http://i2.services.social.microsoft.com/search/Widgets/SearchBox.jss?boxid=HeaderSearchTextBox\u0026btnid=HeaderSearchButton\u0026brand=MSDN\u0026loc=en-US\u0026Refinement=182\u0026focusOnInit=false\u0026iroot=windows%2fhardware\u0026emptyWatermark=true\u0026searchButtonTooltip=Search" },
	{ url: "http://i2.msdn.microsoft.com/Combined.js?resources=0:Header,1:Toc,1:LibraryMemberFilter,2:Toc_Fixed,3:Rating,2:CodeSnippet,2:TopicNotInScope,2:CollapsibleArea,2:VersionSelector,2:SurveyBroker;/Areas/Epx/Themes/Windows/Content:0,/Areas/Library/Content:1,/Areas/Epx/Content/Scripts:2,/Areas/Epx/Themes/Base/Content:3\u0026amp;hashKey=2738C0CC18843CA9EAD45D501FB8031F" },
	{ txt: "$(document).ready(function() {\n        try {\n            var token = $(\"#globalRequestVerification input[name=\u0027__RequestVerificationToken\u0027]\").clone();\n            $(\"#siteFeedbackForm\").append(token);\n        } catch(err) {\n            \n        }\n    });" }
]);

/*]]>*/
</script></body>

<!-- Mirrored from msdn.microsoft.com/en-US/library/windows/hardware/dn376866(v=vs.85).aspx by HTTrack Website Copier/3.x [XR&CO'2013], Mon, 17 Mar 2014 16:57:02 GMT -->
</html>